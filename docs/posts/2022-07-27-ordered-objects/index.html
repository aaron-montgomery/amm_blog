<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aaron Montgomery">
<meta name="dcterms.date" content="2022-07-27">
<meta name="description" content="A coding problem brings an uninvited famous mathematical guest">

<title>AMM - Hey, Who Invited You?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">AMM</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/aaron-montgomery-6b17421b1/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Hey, Who Invited You?</h1>
                  <div>
        <div class="description">
          A coding problem brings an uninvited famous mathematical guest
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">probability</div>
                <div class="quarto-category">simulation</div>
                <div class="quarto-category">monte-carlo</div>
                <div class="quarto-category">eulers-number</div>
                <div class="quarto-category">counterintuitive</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Aaron Montgomery </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 27, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<table class="table">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><img src="letters.jpg" class="img-fluid"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><font size="2">Photo by <a href="https://unsplash.com/@sure_mp?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Surendran MP</a> on <a href="https://unsplash.com/s/photos/letters?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a> </font></td>
</tr>
</tbody>
</table>
<section id="coding-as-a-mathematical-laboratory" class="level1">
<h1>Coding as a Mathematical Laboratory</h1>
<p>I’ve always been a little bit jealous of lab-based sciences like chemistry and physics. To me, there’s something romantic about being able to conduct true <em>experiments</em> in a physical space. Since mathematicians tend to ply our trade in proofs, our “experiments” might be incomplete theorems on a blackboard or half-formed diagrams scrawled on the back of a napkin. We don’t quite have a natural way to “mix some threes with some sevens and add a dash of elevens” in a way that a chemist might do with hydrogen, sulfer, and oxygen. (NB: Chemists should probably not do that.)</p>
<p>Introducing Monte Carlo simulation into my classrooms has been the first thing that has felt to me like a mathematical laboratory. To illustrate what I mean, I’ll tell a story from a recent class: I assigned the following exercise, which was to be completed with Monte Carlo simulations in R.</p>
<blockquote class="blockquote">
<p>Suppose you repeatedly draw upper-case letters from a jar without replacement until the first time you get one that is out of order. What is the expected number of draws for this to occur? (Example: if you draw B-E-R-D, you would stop at D, because it was the first letter you drew that didn’t occur after the previous letter in the alphabet. This would count as 4 draws.)</p>
</blockquote>
<blockquote class="blockquote">
<p>Note that it is OK to ignore the case where you draw all the letters in perfect order, because this is rare enough that it will probably not occur even in trillions of simulations.</p>
</blockquote>
<p>At the point in the class when I assign this problem, this is intended to be a medium-difficulty coding problem. Students have to put together many of the skills we have gathered by that point, including:</p>
<ul>
<li>Monte Carlo simulation</li>
<li>indexing of vectors</li>
<li>loops</li>
</ul>
<p>This exercise has my favorite homework aesthetic, which is <strong>old skills, assembled together in a new way.</strong> But although I’ve long thought it was a pretty good exercise, it wasn’t particularly noteworthy or interesting. At least, I didn’t think it was.</p>
<p>My solution to the problem looked something like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>letters_until_unordered <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  mydraws <span class="ot">&lt;-</span> <span class="fu">sample</span>(LETTERS)   <span class="co"># draw full sample of all 26 letters</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  check <span class="ot">&lt;-</span> <span class="dv">2</span>                   </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the check variable keeps track of how many we have to draw</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># before seeing one that is out of order; this is what the</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># function will return</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">identical</span>(mydraws[<span class="dv">1</span><span class="sc">:</span>check], <span class="fu">sort</span>(mydraws[<span class="dv">1</span><span class="sc">:</span>check])) <span class="sc">&amp;</span> check <span class="sc">&lt;=</span> <span class="dv">26</span>){</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    check <span class="ot">&lt;-</span> check <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  } <span class="co"># loop should continue until vector isn't same as sorted self</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  check</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># note: if we draw all letters in order, this function will return 27</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># this won't happen, even in a simulation, before the heat death of the universe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>That function allows us to compute a Monte Carlo estimate of the expected value from the original question:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">letters_until_unordered</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.7039</code></pre>
</div>
</div>
<p>In one of the early semesters I taught the class, a student correctly solved the question and brought me his code with an interesting question: <strong>is the true answer supposed to be Euler’s number?</strong> That is, should we expect the Monte Carlo simulations to hover around <span class="math inline">\(e \approx 2.718282...\)</span>?</p>
<section id="the-incorrect-answer" class="level2">
<h2 class="anchored" data-anchor-id="the-incorrect-answer">The Incorrect Answer</h2>
<p>My immediate answer was: <strong>No, that must just be a coincidence.</strong></p>
</section>
<section id="the-correct-answer" class="level2">
<h2 class="anchored" data-anchor-id="the-correct-answer">The Correct Answer</h2>
<p>I was wrong. <strong>The true answer was actually <span class="math inline">\(e\)</span>.</strong> Well, almost.</p>
<p>(Quick disclaimer: this result is perfectly well-known to humanity; it just wasn’t well-known to <em>me</em> at the time.)</p>
<p>When the student asked me this question, I replicated my answer a few more times to see if I still thought the resemblence to the magic number <span class="math inline">\(2.718282...\)</span> was accidental.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">letters_until_unordered</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.7228</code></pre>
</div>
</div>
<p>Hmmm…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">letters_until_unordered</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.726</code></pre>
</div>
</div>
<p><em>Very</em> suspicious. Let’s try using more replications for finer accuracy:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="fl">1e5</span>, <span class="fu">letters_until_unordered</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.71936</code></pre>
</div>
</div>
<p>HMMMM…..</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="fl">1e6</span>, <span class="fu">letters_until_unordered</span>())) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.717368</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># runtime starts to get a little long: ~50 seconds on my machine</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>That was hard to ignore, and it practically reeked of Euler’s number. This caught me completely off guard; I had written the problem without any idea that <span class="math inline">\(e\)</span> belonged here at all, and yet… here it was. On the one hand, I shouldn’t have been surprised at all. This is just a Thing That Happens with certain famous mathematical constants like <span class="math inline">\(e\)</span> and <span class="math inline">\(\pi\)</span>; they frequently show up where they frankly have no business being.</p>
<p>I did find myself surprised, though – mostly, by the fact that I had encountered an experiment-driven result, which I am not at all accustomed to. I don’t think I would ever have considered this result were it not for this esoteric homework problem I conjured up (and the help of the keen-eyed student). Monte Carlo simulations gave me something that I imagine must feel a little bit like when a physicist can’t explain a bump on a curve, or when a biologist sees a bacterial growth rate that has no known explanation. The next step for that physicist, or that biologist, and for me, was to ask <em>why</em>.</p>
<p>In this way, I was behaving in the most analogous way possible to an experimental scientist. Such a scientist might discover a fascinating new result in a lab; new results yearn for new <em>theories</em>, and it is those <em>theories</em> that are powerful. Theories are what convey existing and lasting knowledge to humanity. The experiments themselves matter only insofar as they suggest or reveal deeper truths; but the experiments themselves are but partial reflections of those truths. This homework problem doesn’t matter; what makes it tick matters.</p>
<p>This also helped crystallize to me an important lesson about the pedagogy of mathematical education. One of my most important missions in my own classrooms has been to transfer as much agency to students as possible. I tend to gravitate strongly toward <a href="https://www.ams.org/publications/journals/notices/201702/rnoti-p124.pdf">active learning</a> strategies. My teaching philosophy is fairly simple: anything <em>students</em> do is good, and anything <em>I</em> do is inherently less good. Here, too, I’ve long been jealous of lab sciences; they have a built-in pedagogy to invite students to meaningfully engage, right from the very beginning of study. Teaching a course on Monte Carlo simulations has been the first thing I’ve done that has felt just a little bit like a lab.</p>
<p>And yet, the simulations have also underscored for me the importance of understanding “traditional” mathematics; we can discover wildly interesting results through Monte Carlo simulations, but only mathematical reasoning can deliver the all-important <em>why</em>. Simulations are a wonderful way to <em>augment</em> a traditional probability and statistics curriculum, but I don’t think they should <em>replace</em> it.</p>
</section>
<section id="takeaway" class="level2">
<h2 class="anchored" data-anchor-id="takeaway">Takeaway</h2>
<p>Monte Carlo simulations have given me a new way to invite students who can write just a bit of code to <em>experiment</em> and to <em>play</em> in a mathematical space. Inviting students into this style of mathematical “laboratory” has been incredibly rewarding, and it has allowed me to engage students much more fully than I’m typically able to do in introductory probability / statistics classes. It has allowed me to transfer some of the ownership of the subject material to students, which seems to me an unqualified good thing.</p>
<p>However, Monte Carlo simulations are inherently limited in scope. They can give us incredibly interesting results, and they can do so in a much more accessible way than can classical mathematics and statistics. But by themselves, they can never give us that elusive <em>why</em>.</p>
<hr>
</section>
<section id="wait-what-about-the-why-part" class="level2">
<h2 class="anchored" data-anchor-id="wait-what-about-the-why-part">Wait, what about the “Why” part?</h2>
<p>It would be pretty unsatisfying if after all that discussion, we didn’t get around to the proof of the aforementioned result. Once again, to be clear, this result is perfectly well-known; I just hadn’t personally encountered it before. Once the student brought this seeming coincidence to my attention, I immediately set out to try to prove it.</p>
<p>To remind ourselves, here’s the result:</p>
<section id="theorem" class="level3">
<h3 class="anchored" data-anchor-id="theorem">Theorem</h3>
<p>Suppose you repeatedly draw upper-case letters from a jar without replacement until the first time you get one that is out of order. The expected number of draws executed in this fashion will be very slightly less than <span class="math inline">\(e\)</span>.</p>
</section>
<section id="proof" class="level3">
<h3 class="anchored" data-anchor-id="proof">Proof</h3>
<p>For <span class="math inline">\(k \geq 1\)</span>, let <span class="math inline">\(A_k\)</span> denote the event that the first <span class="math inline">\(k\)</span> letters drawn are all in order. (That is: <span class="math inline">\(A_1\)</span> is trivial, <span class="math inline">\(A_2\)</span> holds only if the first two letters are drawn in order, and so forth.) If we let <span class="math inline">\(N\)</span> denote random variable of the number of letters drawn until finding one out of sequence, then we note that <span class="math display">\[ N = 1 + \mathbb 1_{A_1} + \mathbb 1_{A_2} + \dots + \mathbb 1_{A_{26}}\]</span> where <span class="math inline">\(\mathbb 1_{B}\)</span> denotes the indicator function of event <span class="math inline">\(B\)</span>. This is both the most important and least obvious step in the proof; the logic of this step is that <span class="math inline">\(N\)</span> and each <span class="math inline">\(\mathbb 1_{A_k}\)</span> are random variables, meaning they’re functions of some unseen input variable <span class="math inline">\(\omega\)</span>. Here, choosing an <span class="math inline">\(\omega\)</span> determines a full ordering of the letters, and once this has been done, a certain number of events <span class="math inline">\(\{A_1, \dots, A_n\}\)</span> will be fulfilled, making their corresponding indicator variables evaluate to <span class="math inline">\(1\)</span> on that <span class="math inline">\(\omega\)</span>. Summing these indicators will therefore count the events, as desired.</p>
<p>The leading <span class="math inline">\(1\)</span> in the above expression is meant to count the one letter we’ll draw that’s <em>out</em> of order and therefore <em>not</em> counted by the indicator variables; technically, this isn’t very well-defined for the case when we draw all 26 letters in order, but that’s a very low-probability event that we were explicitly invited in the problem statement to ignore, so we’ll just accept the fact that <span class="math inline">\(N\)</span> evaluates to <span class="math inline">\(27\)</span> in that case. (I originally added that detail in the problem statement to alleviate a coding nuisance, and it turned out to alleviate a corresponding mathematical nuisance here.)</p>
<p>The decomposition above is useful, because it therefore follows that <span class="math display">\[ \mathbb E[N] = 1 + \mathbb E \left[ \mathbb 1_{A_1} \right] + \mathbb E \left[ \mathbb 1_{A_2} \right] + \dots + \mathbb E \left[ \mathbb 1_{A_{26}} \right] = 1 + \sum_{k=1}^{26} \mathbb E \left[ \mathbb 1_{A_k} \right].\]</span> I should stop and explicitly acknowledge that this really, really feels like we’re cheating somehow. The <span class="math inline">\(\{A_k\}\)</span> events are definitely <em>not</em> independent; in fact, they’re completely <em>dependent</em>, as <span class="math inline">\(A_{k+1} \subset A_k\)</span>. (If the first twelve letters were perfectly ordered, then the first eleven were also.) However, independence is not required for linearity of expectation.</p>
<p>From here, we recall that <span class="math inline">\(\mathbb E \left[ \mathbb 1_B \right] = \mathbb P(B)\)</span> for any event <span class="math inline">\(B\)</span>, which means that we need only to compute <span class="math inline">\(\mathbb P(A_k)\)</span>. When drawing <span class="math inline">\(k\)</span> objects, there are <span class="math inline">\(k!\)</span> rearrangements of those objects, of which only <span class="math inline">\(1\)</span> is properly ordered, from which it follows that <span class="math inline">\(\mathbb P(A_k) = \frac 1 {k!}\)</span>. Hence, <span class="math display">\[\mathbb E[N] = 1 + \sum_{k=1}^{26} \mathbb P \left( A_k \right) = 1 + \sum_{k=1}^{26} \frac{1}{k!} = \sum_{k=0}^{26} \frac{1}{k!}\]</span> and we notice that this is simply the first few terms of the infinite series <span class="math display">\[\sum_{k=0}^{\infty} \frac{1}{k!} = e.\]</span></p>
<p>So, the true expected value in our original question isn’t <em>quite</em> <span class="math inline">\(e\)</span> – it’s a number just below it. Specifically, it’s <span class="math inline">\(e - \sum_{k=27}^{\infty} \frac{1}{k!}\)</span>. To see how close this is to <span class="math inline">\(e\)</span>, let’s use R to sum the first few terms of the remainder series:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">factorial</span>(<span class="dv">27</span><span class="sc">:</span><span class="dv">1000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.523378e-29</code></pre>
</div>
</div>
<p>Pretty close to <span class="math inline">\(e\)</span>, indeed. And while the true answer isn’t actually <em>quite</em> <span class="math inline">\(e\)</span>, we were never going to be able to distinguish the true answer from <span class="math inline">\(e\)</span> with only a Monte Carlo simulation.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>